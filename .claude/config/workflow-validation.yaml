# å·¥ä½œæµç¨‹å®Œæ•´æ€§é©—è­‰é…ç½®
# ç‰ˆæœ¬: 2.6.0
# æ›´æ–°æ—¥æœŸ: 2025-12-14
# ç›®çš„: ç¢ºä¿æ¯å€‹å¿…è¦çš„ Agent éƒ½è¢«æ­£ç¢ºåŸ·è¡Œï¼ˆå« Google 2025 æ ¸å¿ƒæŒ‡æ¨™ + AI æœå°‹å„ªåŒ–ï¼‰
# æ–°å¢: Memory Agent, Persona Adapter, Performance Optimizer, Quality Predictor
# æ–°å¢: Fact Checker, Humanizer, Persuasion, Storyteller
# æ–°å¢: LLMO, GEO, VSO, CRO æœå°‹å„ªåŒ– Phases

validation:
  enabled: true
  strict_mode: true  # åš´æ ¼æ¨¡å¼ï¼šç¼ºå°‘ä»»ä½•å¿…è¦æ­¥é©Ÿå°±åœæ­¢

# å®šç¾©æ¯å€‹ Phase çš„å¿…è¦ç”¢å‡º
required_phases:

  phase_0:
    name: "æ”¶é›†ç”¨æˆ¶çœŸå¯¦ç¶“é©—"
    agent: "experience-collector"
    required: true
    priority: "critical"  # critical / important / optional
    outputs:
      - file: "experience_profile.md"
        description: "ç”¨æˆ¶çœŸå¯¦ç¶“é©—æª”æ¡ˆ"
        validation:
          must_contain:
            - "ç¶“é©—ç­‰ç´š"
            - "æ’°å¯«è§’åº¦"
            - "çµ•å°ç¦æ­¢è™›æ§‹çš„å…§å®¹"
          min_size_bytes: 500
    skip_conditions:
      - reason: "ç”¨æˆ¶æ˜ç¢ºè¡¨ç¤ºæœ‰æ·±åº¦å¯¦æˆ°ç¶“é©—ä¸”æä¾›çœŸå¯¦æ•¸æ“š"
        requires_confirmation: true
    failure_action: "stop"  # stop / warn / skip

  phase_1:
    name: "è¼¸å…¥è™•ç†èˆ‡åˆ†æ"
    agent: "content-analyst"
    required: true
    priority: "critical"
    outputs:
      - file: "analysis_report.md"
        description: "å…§å®¹åˆ†æå ±å‘Š"
        validation:
          must_contain:
            - "åŸºæœ¬è³‡è¨Š"
            - "çµæ§‹åˆ†æ"
            - "é—œéµå­—æå–"
          min_size_bytes: 1000
      - file: "context.md"
        description: "ä»»å‹™ä¸Šä¸‹æ–‡"
        validation:
          must_contain:
            - "è¼¸å…¥å…§å®¹"
            - "ä»»å‹™ç›®æ¨™"
    skip_conditions:
      - reason: "ä½¿ç”¨è€…æä¾›å®Œæ•´çš„æ–‡ç« è‰ç¨¿ï¼Œä¸éœ€è¦æŠ“å–"
        requires_confirmation: false
    failure_action: "stop"

  phase_2a:
    name: "å¸‚å ´ç ”ç©¶"
    agent: "research-agent"
    required: true
    priority: "important"
    outputs:
      - file: "research_report.md"
        description: "å¸‚å ´ç ”ç©¶å ±å‘Š"
        validation:
          must_contain:
            - "åŸ·è¡Œæ‘˜è¦"
            - "ç†±é–€æ–‡ç« æ¸…å–®"
            - "å¯«ä½œå»ºè­°"
            - "ç›®æ¨™é—œéµå­—"
          min_articles: 5  # è‡³å°‘åˆ†æ 5 ç¯‡æ–‡ç« 
    skip_conditions:
      - reason: "ä½¿ç”¨å¿«å–çš„ç ”ç©¶çµæœï¼ˆ24å°æ™‚å…§ï¼‰"
        requires_confirmation: false
      - reason: "ä½¿ç”¨è€…è¦æ±‚è·³éå¸‚å ´ç ”ç©¶"
        requires_confirmation: true
    failure_action: "warn"  # å¯ä»¥ç¹¼çºŒï¼Œä½†æœƒè­¦å‘Š

  phase_2b:
    name: "é¢¨æ ¼å­¸ç¿’èˆ‡èåˆ"
    agent: "style-matcher"
    required: false  # å¯é¸
    priority: "optional"
    outputs:
      - file: "style_guide.md"
        description: "é¢¨æ ¼èåˆæŒ‡å—"
        validation:
          must_contain:
            - "åƒè€ƒä½œè€…é¢¨æ ¼åˆ†æ"
            - "èåˆç­–ç•¥"
    skip_conditions:
      - reason: "ä½¿ç”¨è€…é¢¨æ ¼å·²æ˜ç¢ºï¼Œä¸éœ€è¦åƒè€ƒå…¶ä»–ä½œè€…"
        requires_confirmation: true
    failure_action: "skip"

  phase_3:
    name: "å…§å®¹å‰µä½œ"
    agent: "writer-agent"
    required: true
    priority: "critical"
    dependencies:
      - phase_0  # å¿…é ˆå…ˆå®Œæˆ Phase 0
      - phase_1  # å¿…é ˆå…ˆå®Œæˆ Phase 1
      # phase_2a å»ºè­°ä½†éå¿…é ˆ
    outputs:
      - file: "draft_final.md"
        description: "æœ€çµ‚åˆç¨¿"
        validation:
          must_contain:
            - "# "  # å¿…é ˆæœ‰æ¨™é¡Œ
          min_size_bytes: 2000  # è‡³å°‘ 2000 å­—
          max_size_bytes: 20000  # ä¸è¶…é 20000 å­—
      - file: "draft_outline.md"
        description: "æ–‡ç« å¤§ç¶±"
        validation:
          must_contain:
            - "æ–‡ç« çµæ§‹"
    failure_action: "stop"

  phase_3_5a:
    name: "è‡ªå‹•åŒ–å“è³ªæª¢æ¸¬"
    agent: "editor-agent"
    required: true
    priority: "critical"
    dependencies:
      - phase_3
    outputs:
      - file: "originality_report.md"
        description: "åŸå‰µæ€§æª¢æ¸¬å ±å‘Šï¼ˆSpamBrain é˜²è­·ï¼‰"
        validation:
          must_contain:
            - "åŸå‰µæ€§è©•åˆ†"
            - "ç¨ç‰¹å…§å®¹æ¯”ä¾‹"
            - "SpamBrain é¢¨éšªç­‰ç´š"
          min_size_bytes: 500
          score_range:
            min: 0
            max: 100
      - file: "helpful_content_report.md"
        description: "æœ‰åƒ¹å€¼å…§å®¹åˆ†æå ±å‘Šï¼ˆHelpful Content Systemï¼‰"
        validation:
          must_contain:
            - "æœ‰åƒ¹å€¼åº¦è©•åˆ†"
            - "äººæœ¬å„ªå…ˆåˆ†æ•¸"
            - "åƒ¹å€¼å¯†åº¦åˆ†æ•¸"
            - "è¡Œå‹•æ€§åˆ†æ•¸"
          min_size_bytes: 800
          score_range:
            min: 0
            max: 100
    decision_points:
      - condition: "originality_score < 50"
        action: "stop"
        message: "âŒ åŸå‰µæ€§ä¸è¶³ï¼ˆ<50ï¼‰ï¼Œæœ‰ SpamBrain æ‡²ç½°é¢¨éšªï¼Œéœ€å¤§å¹…æ”¹å¯«"
      - condition: "originality_score < 70"
        action: "warn"
        message: "âš ï¸ åŸå‰µæ€§åä½ï¼ˆ50-69ï¼‰ï¼Œå»ºè­°æé«˜ç¨ç‰¹æ€§"
      - condition: "helpful_content_score < 50"
        action: "stop"
        message: "âŒ ä¸ç¬¦åˆ Helpful Content æ¨™æº–ï¼ˆ<50ï¼‰ï¼Œéœ€å¢åŠ å¯¦è³ªå…§å®¹"
      - condition: "helpful_content_score < 65"
        action: "warn"
        message: "âš ï¸ æœ‰åƒ¹å€¼åº¦åä½ï¼ˆ50-64ï¼‰ï¼Œå»ºè­°è£œå……åƒ¹å€¼å…§å®¹"
    failure_action: "stop"

  phase_3_5b:
    name: "äººå·¥ç·¨è¼¯å¯©æŸ¥"
    agent: "editor-agent"
    required: true
    priority: "critical"
    dependencies:
      - phase_3
      - phase_3_5a  # å¿…é ˆå…ˆå®Œæˆè‡ªå‹•åŒ–æª¢æ¸¬
    outputs:
      - file: "editor_review.md"
        description: "ç·¨è¼¯å¯©æŸ¥å ±å‘Šï¼ˆæ•´åˆè‡ªå‹•åŒ–æª¢æ¸¬ 20% + äººå·¥å¯©æŸ¥ 80%ï¼‰"
        validation:
          must_contain:
            - "æ•´é«”è©•åˆ†"
            - "å„ç¶­åº¦è©³ç´°è©•åˆ†"
            - "è‡ªå‹•åŒ–å“è³ªæª¢æ¸¬çµæœ"
            - "å»ºè­°çš„ä¸‹ä¸€æ­¥è¡Œå‹•"
          score_range:
            min: 0
            max: 100
    decision_points:
      - condition: "score >= 90"
        action: "continue"
        message: "âœ… æ–‡ç« å“è³ªå„ªç§€ï¼Œç¹¼çºŒ E-E-A-T è©•ä¼°"
      - condition: "score >= 70 and score < 90"
        action: "ask_user"
        message: "âš ï¸ æ–‡ç« å“è³ªè‰¯å¥½ä½†å¯æ”¹é€²ï¼Œæ˜¯å¦è¦ä¿®æ”¹å¾Œå†å„ªåŒ–ï¼Ÿ"
      - condition: "score < 70"
        action: "stop"
        message: "âŒ æ–‡ç« å“è³ªæœªé”æ¨™æº–ï¼Œéœ€è¦é‡å¯«æˆ–å¤§å¹…ä¿®è¨‚"
    failure_action: "stop"

  phase_4a:
    name: "E-E-A-T å“è³ªè©•ä¼°"
    agent: "seo-optimizer"
    required: true
    priority: "important"
    dependencies:
      - phase_3
      - phase_3_5b  # å¿…é ˆé€šéç·¨è¼¯å¯©æŸ¥
      - phase_0  # éœ€è¦ experience_profile.md
    outputs:
      - file: "eeat_report.md"
        description: "E-E-A-T å››ç¶­åº¦è©•ä¼°å ±å‘Š"
        validation:
          must_contain:
            - "E-E-A-T ç¸½åˆ†"
            - "Experience (ç¶“é©—)"
            - "Expertise (å°ˆæ¥­)"
            - "Authoritativeness (æ¬Šå¨)"
            - "Trustworthiness (å¯ä¿¡)"
            - "å…§å®¹é¡å‹"
            - "YMYL ä¸»é¡Œæª¢æ¸¬"
          min_size_bytes: 1000
          score_range:
            min: 0
            max: 100
    decision_points:
      - condition: "is_ymyl and eeat_score < 80"
        action: "warn"
        message: "âš ï¸ YMYL ä¸»é¡Œä½† E-E-A-T < 80ï¼Œå»ºè­°è£œå……ä½œè€…ç¶“é©—èˆ‡æ¬Šå¨ä¾†æº"
      - condition: "not is_ymyl and eeat_score < 60"
        action: "warn"
        message: "âš ï¸ E-E-A-T < 60ï¼Œå»ºè­°æå‡å…§å®¹å°ˆæ¥­æ€§"
    failure_action: "warn"

  phase_4b:
    name: "AI Overviews å„ªåŒ–"
    agent: "seo-optimizer"
    required: true
    priority: "critical"
    dependencies:
      - phase_3
      - phase_4a  # å»ºè­°å…ˆå®Œæˆ E-E-A-T è©•ä¼°
    outputs:
      - file: "ai_summary_report.md"
        description: "AI Overviews æ‘˜è¦å ±å‘Šï¼ˆ50-70 å­—ï¼‰"
        validation:
          must_contain:
            - "æ‘˜è¦å…§å®¹"
            - "50-70 å­—"
            - "é—œéµè¦é»"
            - "å¯è®€æ€§è©•åˆ†"
          min_size_bytes: 300
      - file: "schema_report.md"
        description: "Schema.org markup åˆ†æå ±å‘Š"
        validation:
          must_contain:
            - "Schema é¡å‹"
            - "Article Schema"
          min_size_bytes: 500
      - file: "schema_html.html"
        description: "å¯ç›´æ¥åµŒå…¥çš„ Schema ä»£ç¢¼"
        validation:
          must_contain:
            - "<script type=\"application/ld+json\">"
            - "@type"
          min_size_bytes: 200
    failure_action: "warn"

  phase_4c:
    name: "SEO å„ªåŒ–ï¼ˆæ•´åˆç‰ˆï¼‰"
    agent: "seo-optimizer"
    required: true
    priority: "important"
    dependencies:
      - phase_3
      - phase_3_5b
      - phase_4a  # æ•´åˆ E-E-A-T çµæœ
      - phase_4b  # æ•´åˆ AI Overviews çµæœ
    outputs:
      - file: "final_article.md"
        description: "SEO å„ªåŒ–å¾Œçš„æœ€çµ‚æ–‡ç« ï¼ˆåŒ…å«æ‰€æœ‰å„ªåŒ–ï¼‰"
        validation:
          must_contain:
            - "title:"
            - "meta_description:"
            - "keywords:"
      - file: "seo_report.md"
        description: "SEO å„ªåŒ–ç¸½è©•å ±å‘Šï¼ˆ7 ç¶­åº¦è©•åˆ†ï¼‰"
        validation:
          must_contain:
            - "SEO ç¸½åˆ†"
            - "AI Overviews å„ªåŒ–"
            - "E-E-A-T å“è³ª"
            - "æœå°‹æ„åœ–åŒ¹é…"
            - "é—œéµå­—å„ªåŒ–"
          score_range:
            min: 0
            max: 100
      - file: "intent_analysis.md"
        description: "æœå°‹æ„åœ–åˆ†æå ±å‘Š"
        validation:
          must_contain:
            - "ä¸»è¦æ„åœ–"
            - "åŒ¹é…åº¦"
    decision_points:
      - condition: "seo_score >= 85"
        action: "continue"
        message: "âœ… SEO å„ªåŒ–å„ªç§€ï¼Œå¯é€²å…¥ç™¼å¸ƒæµç¨‹"
      - condition: "seo_score >= 70 and seo_score < 85"
        action: "warn"
        message: "âš ï¸ SEO å„ªåŒ–è‰¯å¥½ä½†æœ‰æ”¹é€²ç©ºé–“"
      - condition: "seo_score < 70"
        action: "warn"
        message: "âš ï¸ SEO å„ªåŒ–ä¸è¶³ï¼Œå»ºè­°æª¢è¦–å ±å‘Šä¸¦æ”¹é€²"
    failure_action: "warn"

  phase_5:
    name: "WordPress ç™¼å¸ƒ"
    agent: "publisher-agent"
    required: false  # ä½¿ç”¨è€…å¯èƒ½é¸æ“‡æ‰‹å‹•ç™¼å¸ƒ
    priority: "optional"
    dependencies:
      - phase_4c  # å¿…é ˆå®Œæˆ SEO å„ªåŒ–
    outputs:
      - file: "publish_report.md"
        description: "ç™¼å¸ƒå ±å‘Š"
        validation:
          must_contain:
            - "WordPress URL"
            - "æ–‡ç«  ID"
    skip_conditions:
      - reason: "ä½¿ç”¨è€…é¸æ“‡æ‰‹å‹•ç™¼å¸ƒ"
        requires_confirmation: true
    failure_action: "warn"

  # ============================================================
  # v2.1.0 æ–°å¢ Phases (å“è³ªå¼·åŒ–)
  # ============================================================

  phase_3_6:
    name: "äº‹å¯¦é©—è­‰"
    agent: "fact-checker-agent"
    required: true
    priority: "critical"
    dependencies:
      - phase_3  # å¿…é ˆå…ˆå®Œæˆå¯«ä½œ
    outputs:
      - file: "fact_check_report.md"
        description: "äº‹å¯¦é©—è­‰å ±å‘Šï¼ˆé˜²æ­¢ LLM å¹»è¦ºï¼‰"
        validation:
          must_contain:
            - "å¯ä¿¡åº¦è©•åˆ†"
            - "äº‹å¯¦é™³è¿°"
            - "é©—è­‰çµæœ"
          min_size_bytes: 500
          score_range:
            min: 0
            max: 100
    decision_points:
      - condition: "credibility_score < 70"
        action: "stop"
        message: "âŒ å¯ä¿¡åº¦ä¸è¶³ï¼ˆ<70ï¼‰ï¼Œå­˜åœ¨äº‹å¯¦éŒ¯èª¤é¢¨éšª"
      - condition: "credibility_score >= 70"
        action: "continue"
        message: "âœ… äº‹å¯¦é©—è­‰é€šé"
    failure_action: "stop"

  phase_3_7:
    name: "å…§å®¹äººé¡åŒ–"
    agent: "humanizer-agent"
    required: true
    priority: "important"
    dependencies:
      - phase_3
      - phase_3_6
    outputs:
      - file: "humanized_draft.md"
        description: "äººé¡åŒ–è™•ç†å¾Œçš„æ–‡ç« "
        validation:
          min_size_bytes: 2000
      - file: "humanization_report.md"
        description: "äººé¡åŒ–è™•ç†å ±å‘Šï¼ˆAI åµæ¸¬åˆ†æï¼‰"
        validation:
          must_contain:
            - "AI åµæ¸¬åˆ†æ•¸"
            - "å¥å¼è®ŠåŒ–"
            - "æƒ…æ„Ÿæ³¨å…¥"
          min_size_bytes: 400
    decision_points:
      - condition: "ai_detection_score > 40"
        action: "warn"
        message: "âš ï¸ AI åµæ¸¬é¢¨éšªåé«˜ï¼ˆ>40ï¼‰ï¼Œå»ºè­°åŠ å¼·äººé¡åŒ–"
    failure_action: "warn"

  # ============================================================
  # v2.2.0 æ–°å¢ Phases (èªªæœåŠ›æå‡)
  # ============================================================

  phase_3_8:
    name: "èªªæœåŠ›å¼·åŒ–"
    agent: "persuasion-agent"
    required: true
    priority: "important"
    dependencies:
      - phase_3_7
    outputs:
      - file: "persuasive_draft.md"
        description: "èªªæœåŠ›å¼·åŒ–å¾Œçš„æ–‡ç« "
        validation:
          min_size_bytes: 2000
      - file: "persuasion_report.md"
        description: "èªªæœåŠ›åˆ†æå ±å‘Šï¼ˆAIDA/PAS/4Csï¼‰"
        validation:
          must_contain:
            - "èªªæœåŠ›è©•åˆ†"
            - "CTA"
            - "å¿ƒç†è§¸ç™¼"
          min_size_bytes: 500
    decision_points:
      - condition: "persuasion_score < 70"
        action: "warn"
        message: "âš ï¸ èªªæœåŠ›åä½ï¼ˆ<70ï¼‰ï¼Œå»ºè­°åŠ å¼· CTA å’Œå¿ƒç†è§¸ç™¼"
    failure_action: "warn"

  phase_3_9:
    name: "æ•…äº‹æ•˜äº‹å¢å¼·"
    agent: "storyteller-agent"
    required: false
    priority: "optional"
    dependencies:
      - phase_3_8
    outputs:
      - file: "story_enhanced_draft.md"
        description: "æ•…äº‹æ•˜äº‹å¼·åŒ–å¾Œçš„æ–‡ç« "
        validation:
          min_size_bytes: 2000
      - file: "story_arc_report.md"
        description: "æ•…äº‹å¼§ç·šåˆ†æå ±å‘Š"
        validation:
          must_contain:
            - "æ•˜äº‹å¼·åº¦"
            - "æ•…äº‹çµæ§‹"
          min_size_bytes: 400
    skip_conditions:
      - reason: "æ–‡ç« é¡å‹ä¸é©åˆæ•…äº‹åŒ–ï¼ˆå¦‚æŠ€è¡“æ–‡æª”ï¼‰"
        requires_confirmation: true
    failure_action: "skip"

  # ============================================================
  # v2.3.0 æ–°å¢ Phases (æ™ºæ…§é€²åŒ–)
  # ============================================================

  phase_11:
    name: "è·¨ Session å­¸ç¿’"
    agent: "memory-agent"
    required: true
    priority: "important"
    run_mode: "background"  # èƒŒæ™¯æŒçºŒé‹è¡Œ
    outputs:
      - file: "memory_insights.md"
        description: "å­¸ç¿’æ´å¯Ÿå ±å‘Š"
        validation:
          optional: true
    skip_conditions:
      - reason: "é¦–æ¬¡ä½¿ç”¨ç³»çµ±ï¼Œç„¡æ­·å²æ•¸æ“š"
        requires_confirmation: false
    failure_action: "warn"

  phase_12:
    name: "å¤šè®€è€…ç‰ˆæœ¬ç”Ÿæˆ"
    agent: "persona-adapter-agent"
    required: false
    priority: "optional"
    dependencies:
      - phase_4c  # å¿…é ˆå®Œæˆ SEO å„ªåŒ–
    outputs:
      - file: "adapted_versions/"
        description: "å¤šè®€è€…ç‰ˆæœ¬ç›®éŒ„"
        validation:
          optional: true
      - file: "persona_adaptation_report.md"
        description: "è®€è€…é©é…å ±å‘Š"
        validation:
          must_contain:
            - "ç›®æ¨™ Persona"
            - "é©é…å“è³ª"
          min_size_bytes: 300
    skip_conditions:
      - reason: "ä¸éœ€è¦å¤šè®€è€…ç‰ˆæœ¬"
        requires_confirmation: true
    failure_action: "skip"

  # ============================================================
  # v2.4.0 æ–°å¢ Phases (æ•ˆèƒ½å„ªåŒ–)
  # ============================================================

  phase_13:
    name: "æ•ˆèƒ½ç›£æ§"
    agent: "performance-optimizer-agent"
    required: true
    priority: "important"
    run_mode: "background"  # èƒŒæ™¯æŒçºŒé‹è¡Œ
    outputs:
      - file: "performance_report.md"
        description: "æ•ˆèƒ½åˆ†æå ±å‘Š"
        validation:
          must_contain:
            - "åŸ·è¡Œæ™‚é–“"
            - "æ•ˆèƒ½è©•ç´š"
          min_size_bytes: 300
      - file: "optimization_suggestions.json"
        description: "å„ªåŒ–å»ºè­°"
        validation:
          optional: true
    failure_action: "warn"

  phase_3_4:
    name: "å“è³ªé æ¸¬"
    agent: "quality-predictor-agent"
    required: true
    priority: "important"
    dependencies:
      - phase_3
    outputs:
      - file: "quality_prediction.md"
        description: "å“è³ªé æ¸¬å ±å‘Š"
        validation:
          must_contain:
            - "é æ¸¬åˆ†æ•¸"
            - "é¢¨éšªè©•ä¼°"
          min_size_bytes: 400
      - file: "risk_assessment.json"
        description: "é¢¨éšªè©•ä¼° JSON"
        validation:
          optional: true
    decision_points:
      - condition: "predicted_score >= 85"
        action: "continue"
        message: "âœ… é æ¸¬å“è³ªå„ªç§€ï¼Œå¯è·³ééƒ¨åˆ†å¼·åŒ– Phases"
      - condition: "predicted_score >= 70"
        action: "continue"
        message: "âš ï¸ é æ¸¬å“è³ªè‰¯å¥½ï¼Œå»ºè­°å®Œæ•´åŸ·è¡Œæ‰€æœ‰ Phases"
      - condition: "predicted_score < 70"
        action: "warn"
        message: "âš ï¸ é æ¸¬å“è³ªåä½ï¼Œå»ºè­°é€€å›ä¿®æ”¹"
    failure_action: "warn"

  # ============================================================
  # v2.6.0 æ–°å¢ Phases (Search Everywhere)
  # ============================================================

  phase_4d:
    name: "LLMO å¤§æ¨¡å‹å„ªåŒ–"
    agent: "seo-optimizer"
    required: true
    priority: "important"
    dependencies:
      - phase_4c
    outputs:
      - file: "llmo_report.md"
        description: "LLMO å„ªåŒ–å ±å‘Š"
        validation:
          must_contain:
            - "çµæ§‹åŒ–å…§å®¹"
            - "æ˜ç¢ºå®šç¾©"
            - "æ•¸æ“šå¼•ç”¨"
          min_size_bytes: 500
    decision_points:
      - condition: "llmo_score >= 80"
        action: "continue"
        message: "âœ… LLMO å„ªåŒ–è‰¯å¥½ï¼Œå…§å®¹æ˜“è¢« AI å¼•ç”¨"
      - condition: "llmo_score < 60"
        action: "warn"
        message: "âš ï¸ LLMO å„ªåŒ–ä¸è¶³ï¼Œå»ºè­°åŠ å¼·çµæ§‹åŒ–å’Œå®šç¾©"
    failure_action: "warn"

  phase_4e:
    name: "GEO ç”Ÿæˆå¼æœå°‹å„ªåŒ–"
    agent: "seo-optimizer"
    required: true
    priority: "important"
    dependencies:
      - phase_4d
    outputs:
      - file: "geo_report.md"
        description: "GEO å„ªåŒ–å ±å‘Š"
        validation:
          must_contain:
            - "å¼•ç”¨å„ªåŒ–"
            - "å…§å®¹æ·±åº¦"
            - "å¯¦é«”æ¨™è¨˜"
          min_size_bytes: 400
    failure_action: "warn"

  phase_4f:
    name: "VSO èªéŸ³æœå°‹å„ªåŒ–"
    agent: "seo-optimizer"
    required: false
    priority: "optional"
    dependencies:
      - phase_4e
    outputs:
      - file: "vso_report.md"
        description: "VSO å„ªåŒ–å ±å‘Š"
        validation:
          must_contain:
            - "å•å¥æ¨™é¡Œ"
            - "ç›´æ¥å›ç­”"
          min_size_bytes: 300
    skip_conditions:
      - reason: "å…§å®¹ä¸é©åˆèªéŸ³æœå°‹å„ªåŒ–"
        requires_confirmation: true
    failure_action: "skip"

  phase_4g:
    name: "CRO è½‰æ›ç‡å„ªåŒ–"
    agent: "seo-optimizer"
    required: true
    priority: "important"
    dependencies:
      - phase_4e
    outputs:
      - file: "cro_report.md"
        description: "CRO å„ªåŒ–å ±å‘Š"
        validation:
          must_contain:
            - "CTA"
            - "ç¤¾æœƒè­‰æ˜"
          min_size_bytes: 300
    failure_action: "warn"

  phase_4h:
    name: "AISO çµ±ä¸€è©•åˆ†"
    agent: "seo-optimizer"
    required: true
    priority: "critical"
    dependencies:
      - phase_4c
      - phase_4d
      - phase_4e
      - phase_4g
    outputs:
      - file: "search_everywhere_report.md"
        description: "Search Everywhere çµ±ä¸€è©•åˆ†å ±å‘Š"
        validation:
          must_contain:
            - "AISO è©•åˆ†"
            - "SEO"
            - "GEO"
            - "LLMO"
            - "AEO"
            - "E-E-A-T"
            - "å¹³å°å¯è¦‹åº¦"
          min_size_bytes: 800
    decision_points:
      - condition: "aiso_score >= 85"
        action: "continue"
        message: "âœ… Search Everywhere å„ªåŒ–å„ªç§€"
      - condition: "aiso_score >= 70"
        action: "warn"
        message: "âš ï¸ Search Everywhere å„ªåŒ–è‰¯å¥½ï¼Œä½†æœ‰æ”¹é€²ç©ºé–“"
      - condition: "aiso_score < 70"
        action: "warn"
        message: "âš ï¸ Search Everywhere å„ªåŒ–ä¸è¶³ï¼Œå»ºè­°æ”¹é€²"
    failure_action: "warn"

  # ============================================================
  # v2.0.0 æ–°å¢ Phases (MCP æ•´åˆ)
  # ============================================================

  phase_6:
    name: "è¡ŒéŠ·ç´ æç”Ÿæˆ"
    agent: "marketing-optimizer"
    required: false
    priority: "optional"
    dependencies:
      - phase_5  # å»ºè­°åœ¨ç™¼å¸ƒå¾ŒåŸ·è¡Œ
    outputs:
      - file: "marketing_assets.md"
        description: "è¡ŒéŠ·ç´ æåŒ… (æ¨™é¡Œè®Šé«”ã€ç¤¾ç¾¤æ–‡æ¡ˆã€åœ–ç‰‡å»ºè­°)"
        validation:
          must_contain:
            - "æ¨™é¡Œè®Šé«”"
            - "ç¤¾ç¾¤æ–‡æ¡ˆ"
            - "Meta Description"
          min_size_bytes: 1000
    skip_conditions:
      - reason: "ä½¿ç”¨è€…ä¸éœ€è¦é¡å¤–è¡ŒéŠ·ç´ æ"
        requires_confirmation: true
    failure_action: "warn"

  phase_7:
    name: "Analytics æ•¸æ“šå ±å‘Š (MCP)"
    agent: "analytics-reporter"
    required: false
    priority: "important"
    dependencies:
      - phase_5  # éœ€è¦æœ‰ç™¼å¸ƒçš„æ–‡ç«  URL
    outputs:
      - file: "analytics_report.md"
        description: "Google Analytics çœŸå¯¦æµé‡æ•¸æ“šåˆ†æå ±å‘Š"
        validation:
          must_contain:
            - "æ•¸æ“šä¾†æº"
            - "æµé‡è¶¨å‹¢"
            - "æ”¹é€²å»ºè­°"
          min_size_bytes: 800
      - file: "analytics_charts.png"
        description: "æµé‡è¶¨å‹¢åœ–è¡¨ (å¯é¸)"
        validation:
          optional: true
    mcp_integration:
      required_mcp: "google-analytics"
      fallback_mode: "use_mock_data"
      fallback_warning: "âš ï¸ Google Analytics MCP æœªé…ç½®ï¼Œä½¿ç”¨æ¨¡æ“¬æ•¸æ“š"
    skip_conditions:
      - reason: "ä½¿ç”¨è€…ä¸éœ€è¦ Analytics åˆ†æ"
        requires_confirmation: true
      - reason: "MCP æœªé…ç½®ä¸”ä¸ä½¿ç”¨æ¨¡æ“¬æ•¸æ“š"
        requires_confirmation: false
    failure_action: "warn"

  phase_8:
    name: "å¤šå¹³å°ç™¼å¸ƒ (Twitter + Notion)"
    agent: "publisher-agent"
    required: false
    priority: "optional"
    dependencies:
      - phase_5  # å¿…é ˆå…ˆå®Œæˆ WordPress ç™¼å¸ƒ
    outputs:
      - file: "twitter_thread.md"
        description: "Twitter Thread æ–‡æ¡ˆ (7-10 å‰‡æ¨æ–‡)"
        validation:
          must_contain:
            - "æ¨æ–‡ 1"
            - "æ¨æ–‡"
          min_size_bytes: 500
      - file: "notion_calendar.md"
        description: "Notion å…§å®¹æ—¥æ›†æ›´æ–°è¨˜éŒ„"
        validation:
          must_contain:
            - "Notion"
          min_size_bytes: 200
    mcp_integration:
      required_mcp: ["twitter", "notion"]
      fallback_mode: "generate_content_only"
      fallback_warning: "âš ï¸ Twitter/Notion MCP æœªé…ç½®ï¼Œåƒ…ç”Ÿæˆæ–‡æ¡ˆä¸è‡ªå‹•ç™¼å¸ƒ"
    skip_conditions:
      - reason: "ä½¿ç”¨è€…ä¸ä½¿ç”¨ Twitter æˆ– Notion"
        requires_confirmation: true
    failure_action: "warn"

  phase_9:
    name: "A/B Testing è‡ªå‹•åŒ–"
    agent: "seo-optimizer"
    required: false
    priority: "optional"
    dependencies:
      - phase_5  # éœ€è¦ç™¼å¸ƒçš„æ–‡ç« 
      - phase_6  # éœ€è¦æ¨™é¡Œè®Šé«”
    outputs:
      - file: "ab_test_plan.md"
        description: "A/B æ¸¬è©¦è¨ˆåŠƒ (æ¨™é¡Œã€Meta Description è®Šé«”)"
        validation:
          must_contain:
            - "æ¸¬è©¦å‡è¨­"
            - "è®Šé«” A"
            - "è®Šé«” B"
            - "è¿½è¹¤æŒ‡æ¨™"
          min_size_bytes: 600
    skip_conditions:
      - reason: "ä½¿ç”¨è€…ä¸é€²è¡Œ A/B æ¸¬è©¦"
        requires_confirmation: true
    failure_action: "warn"

  phase_10:
    name: "æ•´åˆæ•¸æ“šå„€è¡¨æ¿"
    agent: "analytics-reporter"
    required: false
    priority: "optional"
    dependencies:
      - phase_7  # éœ€è¦ Analytics æ•¸æ“š
    outputs:
      - file: "dashboard_report.md"
        description: "æ•´åˆå„€è¡¨æ¿å ±å‘Š (æµé‡ã€SEOã€ç¤¾ç¾¤æ•¸æ“š)"
        validation:
          must_contain:
            - "æ•´é«”è¡¨ç¾"
            - "é—œéµæŒ‡æ¨™"
          min_size_bytes: 800
    mcp_integration:
      required_mcp: "google-analytics"
      fallback_mode: "partial_dashboard"
      fallback_warning: "âš ï¸ å„€è¡¨æ¿ä½¿ç”¨éƒ¨åˆ†æ¨¡æ“¬æ•¸æ“š"
    skip_conditions:
      - reason: "ä½¿ç”¨è€…ä¸éœ€è¦æ•´åˆå„€è¡¨æ¿"
        requires_confirmation: true
    failure_action: "warn"

# é©—è­‰é»é…ç½®
validation_checkpoints:

  checkpoint_after_phase_0:
    enabled: true
    message: |
      ğŸ“‹ Phase 0 å®Œæˆæª¢æŸ¥

      å¿…é ˆç¢ºèªï¼š
      - [ ] experience_profile.md å·²ç”Ÿæˆ
      - [ ] ç”¨æˆ¶ç¶“é©—ç­‰ç´šå·²è¨˜éŒ„
      - [ ] æ’°å¯«è§’åº¦å·²ç¢ºå®š
      - [ ] ã€Œå¯å¯«/ä¸å¯å¯«ã€æŒ‡å¼•å·²æ˜ç¢º

      æ˜¯å¦ç¹¼çºŒï¼Ÿ

  checkpoint_after_phase_2:
    enabled: true
    message: |
      ğŸ“‹ Phase 2 å®Œæˆæª¢æŸ¥

      å¿…é ˆç¢ºèªï¼š
      - [ ] research_report.md å·²ç”Ÿæˆï¼ˆæˆ–ä½¿ç”¨å¿«å–ï¼‰
      - [ ] è‡³å°‘æœ‰ 5 ç¯‡ç†±é–€æ–‡ç« åˆ†æ
      - [ ] ç›®æ¨™é—œéµå­—å·²ç¢ºå®š
      - [ ] style_guide.md å·²ç”Ÿæˆï¼ˆå¦‚éœ€è¦ï¼‰

      æ˜¯å¦ç¹¼çºŒé€²å…¥å…§å®¹å‰µä½œï¼Ÿ

  checkpoint_after_phase_3:
    enabled: true
    message: |
      ğŸ“‹ Phase 3 å®Œæˆæª¢æŸ¥

      å¿…é ˆç¢ºèªï¼š
      - [ ] draft_final.md å·²ç”Ÿæˆ
      - [ ] å­—æ•¸åœ¨ 2000-20000 ç¯„åœå…§
      - [ ] æ–‡ç« åŒ…å«æ¨™é¡Œã€æ­£æ–‡ã€çµè«–
      - [ ] å·²åŸ·è¡ŒçœŸå¯¦æ€§è‡ªæˆ‘æª¢æŸ¥

      æ˜¯å¦é€²å…¥ç·¨è¼¯å¯©æŸ¥ï¼Ÿ

  checkpoint_after_phase_3_5a:
    enabled: true
    message: |
      ğŸ“‹ Phase 3.5a è‡ªå‹•åŒ–å“è³ªæª¢æ¸¬å®Œæˆ

      å¿…é ˆç¢ºèªï¼š
      - [ ] originality_report.md å·²ç”Ÿæˆ
      - [ ] åŸå‰µæ€§è©•åˆ†: {originality_score}/100
      - [ ] SpamBrain é¢¨éšª: {risk_level}
      - [ ] helpful_content_report.md å·²ç”Ÿæˆ
      - [ ] æœ‰åƒ¹å€¼åº¦è©•åˆ†: {helpful_score}/100

      æ±ºç­–ï¼š
      - åŸå‰µæ€§ < 50 â†’ âŒ åœæ­¢ï¼Œéœ€å¤§å¹…æ”¹å¯«
      - æœ‰åƒ¹å€¼åº¦ < 50 â†’ âŒ åœæ­¢ï¼Œéœ€å¢åŠ å¯¦è³ªå…§å®¹
      - å…©è€…éƒ½ >= 70 â†’ âœ… ç¹¼çºŒäººå·¥å¯©æŸ¥

  checkpoint_after_phase_3_5b:
    enabled: true
    message: |
      ğŸ“‹ Phase 3.5b äººå·¥ç·¨è¼¯å¯©æŸ¥å®Œæˆ

      å¿…é ˆç¢ºèªï¼š
      - [ ] editor_review.md å·²ç”Ÿæˆ
      - [ ] ç¸½åˆ†å·²è¨ˆç®—ï¼ˆæ•´åˆè‡ªå‹•åŒ– 20% + äººå·¥ 80%ï¼‰
      - [ ] è©•ç´šå·²ç¢ºå®šï¼ˆA+/A/B+/B/C/D/Fï¼‰
      - [ ] æ±ºç­–å»ºè­°å·²æä¾›

      è©•åˆ†: {score}/100
      è©•ç´š: {grade}

      æ ¹æ“šè©•åˆ†æ±ºå®šä¸‹ä¸€æ­¥ï¼š
      - 90+ åˆ† â†’ ç›´æ¥é€²å…¥ E-E-A-T è©•ä¼°
      - 70-89 åˆ† â†’ è©¢å•æ˜¯å¦ä¿®æ”¹
      - <70 åˆ† â†’ å¿…é ˆé‡å¯«æˆ–ä¿®è¨‚

  checkpoint_after_phase_4:
    enabled: true
    message: |
      ğŸ“‹ Phase 4 SEO å„ªåŒ–å®Œæˆæª¢æŸ¥

      å¿…é ˆç¢ºèªï¼š
      - [ ] eeat_report.md å·²ç”Ÿæˆ
      - [ ] E-E-A-T ç¸½åˆ†: {eeat_score}/100
      - [ ] YMYL ä¸»é¡Œ: {is_ymyl}
      - [ ] ai_summary_report.md å·²ç”Ÿæˆ
      - [ ] AI Overviews æ‘˜è¦: {summary_length} å­—
      - [ ] schema_report.md å’Œ schema_html.html å·²ç”Ÿæˆ
      - [ ] final_article.md å·²ç”Ÿæˆ
      - [ ] SEO ç¸½åˆ†: {seo_score}/100

      Google 2025 æŒ‡æ¨™ï¼š
      - AI Overviews å„ªåŒ–: {ai_overviews_score}/20
      - E-E-A-T å“è³ª: {eeat_seo_score}/20
      - æœå°‹æ„åœ–åŒ¹é…: {intent_score}/20

      æ˜¯å¦ç¹¼çºŒç™¼å¸ƒï¼Ÿ

  checkpoint_before_publish:
    enabled: true
    message: |
      ğŸ“‹ ç™¼å¸ƒå‰æœ€çµ‚æª¢æŸ¥

      å¿…é ˆç¢ºèªï¼š
      - [ ] final_article.md å·²ç”Ÿæˆ
      - [ ] SEO ç¸½åˆ† >= 70
      - [ ] åŸå‰µæ€§è©•åˆ† >= 70
      - [ ] æœ‰åƒ¹å€¼åº¦è©•åˆ† >= 70
      - [ ] E-E-A-T è©•åˆ†ç¬¦åˆæ¨™æº–
      - [ ] åœ–ç‰‡å·²ç”Ÿæˆï¼ˆå¦‚éœ€è¦ï¼‰
      - [ ] Schema markup å·²åµŒå…¥
      - [ ] æ‰€æœ‰å¿…è¦æª”æ¡ˆéƒ½å·²å°±ä½

      æ˜¯å¦åŸ·è¡Œç™¼å¸ƒï¼Ÿ

  # ============================================================
  # v2.0.0 æ–°å¢æª¢æŸ¥é» (MCP æ•´åˆ)
  # ============================================================

  checkpoint_after_phase_6:
    enabled: true
    message: |
      ğŸ“‹ Phase 6 è¡ŒéŠ·ç´ æç”Ÿæˆå®Œæˆæª¢æŸ¥

      å¿…é ˆç¢ºèªï¼š
      - [ ] marketing_assets.md å·²ç”Ÿæˆ
      - [ ] æ¨™é¡Œè®Šé«”æ•¸é‡ (å»ºè­° 3-5 å€‹)
      - [ ] ç¤¾ç¾¤æ–‡æ¡ˆå·²ç”Ÿæˆ (Facebook, Twitter, LinkedIn)
      - [ ] Meta Description è®Šé«”å·²ç”Ÿæˆ

      æ˜¯å¦ç¹¼çºŒ Phase 7 (Analytics å ±å‘Š)?

  checkpoint_after_phase_7:
    enabled: true
    message: |
      ğŸ“‹ Phase 7 Analytics å ±å‘Šå®Œæˆæª¢æŸ¥

      å¿…é ˆç¢ºèªï¼š
      - [ ] analytics_report.md å·²ç”Ÿæˆ
      - [ ] æ•¸æ“šä¾†æºæ¨™è¨» (çœŸå¯¦ GA æ•¸æ“š æˆ– æ¨¡æ“¬æ•¸æ“š)
      - [ ] æµé‡è¶¨å‹¢åˆ†æå·²å®Œæˆ
      - [ ] æ”¹é€²å»ºè­°å…·é«”å¯è¡Œ

      MCP ç‹€æ…‹:
      - Google Analytics MCP: {mcp_status}
      - æ•¸æ“šé¡å‹: {data_type}

      æ˜¯å¦ç¹¼çºŒ Phase 8 (å¤šå¹³å°ç™¼å¸ƒ)?

  checkpoint_after_phase_8:
    enabled: true
    message: |
      ğŸ“‹ Phase 8 å¤šå¹³å°ç™¼å¸ƒå®Œæˆæª¢æŸ¥

      å¿…é ˆç¢ºèªï¼š
      - [ ] twitter_thread.md å·²ç”Ÿæˆ (7-10 å‰‡æ¨æ–‡)
      - [ ] notion_calendar.md å·²ç”Ÿæˆ
      - [ ] Twitter ç™¼å¸ƒç‹€æ…‹: {twitter_status}
      - [ ] Notion æ›´æ–°ç‹€æ…‹: {notion_status}

      MCP ç‹€æ…‹:
      - Twitter MCP: {twitter_mcp_status}
      - Notion MCP: {notion_mcp_status}

      æ˜¯å¦ç¹¼çºŒ Phase 9 (A/B Testing)?

  checkpoint_after_phase_10:
    enabled: true
    message: |
      ğŸ“‹ Phase 10 æ•´åˆå„€è¡¨æ¿å®Œæˆæª¢æŸ¥

      å¿…é ˆç¢ºèªï¼š
      - [ ] dashboard_report.md å·²ç”Ÿæˆ
      - [ ] æ•´é«”è¡¨ç¾æ•¸æ“šå®Œæ•´
      - [ ] é—œéµæŒ‡æ¨™è¿½è¹¤è¨­å®š
      - [ ] æ•¸æ“šè¦–è¦ºåŒ–åœ–è¡¨å·²ç”Ÿæˆ (å¯é¸)

      ğŸ‰ v2.0.0 å®Œæ•´å·¥ä½œæµç¨‹å·²å®Œæˆï¼

      ç”Ÿæˆçš„æª”æ¡ˆç¸½è¦½:
      - Phase 0-5: æ ¸å¿ƒå…§å®¹å‰µä½œå’Œç™¼å¸ƒ
      - Phase 6: è¡ŒéŠ·ç´ æ
      - Phase 7: Analytics å ±å‘Š
      - Phase 8: å¤šå¹³å°ç™¼å¸ƒ
      - Phase 9: A/B æ¸¬è©¦è¨ˆåŠƒ (å¯é¸)
      - Phase 10: æ•´åˆå„€è¡¨æ¿

# éŒ¯èª¤è™•ç†ç­–ç•¥
error_handling:

  missing_output:
    message: |
      âŒ éŒ¯èª¤ï¼šç¼ºå°‘å¿…è¦çš„è¼¸å‡ºæª”æ¡ˆ

      Phase: {phase_name}
      Agent: {agent_name}
      ç¼ºå°‘æª”æ¡ˆ: {missing_file}

      å¯èƒ½åŸå› ï¼š
      1. Agent åŸ·è¡Œå¤±æ•—
      2. æª”æ¡ˆè·¯å¾‘éŒ¯èª¤
      3. Agent æœªè¢«æ­£ç¢ºèª¿ç”¨

      å»ºè­°è¡Œå‹•ï¼š
      1. æª¢æŸ¥ Agent æ˜¯å¦è¢«èª¿ç”¨
      2. æŸ¥çœ‹éŒ¯èª¤æ—¥èªŒ
      3. é‡æ–°åŸ·è¡Œè©² Phase
    action: "stop_and_report"

  invalid_content:
    message: |
      âš ï¸ è­¦å‘Šï¼šè¼¸å‡ºå…§å®¹æœªé€šéé©—è­‰

      Phase: {phase_name}
      æª”æ¡ˆ: {file_name}
      å•é¡Œ: {validation_issue}

      å»ºè­°è¡Œå‹•ï¼š
      1. æª¢æŸ¥æª”æ¡ˆå…§å®¹
      2. ç¢ºèª Agent æ­£ç¢ºåŸ·è¡Œ
      3. å¯èƒ½éœ€è¦é‡æ–°ç”Ÿæˆ
    action: "warn_and_ask"

  dependency_not_met:
    message: |
      âŒ éŒ¯èª¤ï¼šå‰ç½®æ¢ä»¶æœªæ»¿è¶³

      ç•¶å‰ Phase: {current_phase}
      ç¼ºå°‘çš„å‰ç½® Phase: {missing_dependency}

      ç„¡æ³•ç¹¼çºŒåŸ·è¡Œï¼Œå¿…é ˆå…ˆå®Œæˆå‰ç½®æ­¥é©Ÿã€‚
    action: "stop"

# æ—¥èªŒè¨˜éŒ„
logging:
  enabled: true
  log_file: ".claude/logs/workflow_validation.log"
  log_level: "INFO"  # DEBUG / INFO / WARN / ERROR

  log_each_phase: true
  log_validations: true
  log_decisions: true

  format: |
    [{timestamp}] [{level}] Phase {phase_id}: {message}

# é€²åº¦è¿½è¹¤
progress_tracking:
  enabled: true
  file: "output/session_{timestamp}/workflow_progress.json"

  update_on:
    - phase_start
    - phase_complete
    - validation_check
    - checkpoint_reached
    - error_occurred

  include:
    - phase_name
    - agent_name
    - status  # pending / in_progress / completed / failed / skipped
    - start_time
    - end_time
    - duration_seconds
    - outputs_generated
    - validations_passed
    - validations_failed

# è‡ªå‹•ä¿®å¾©ç­–ç•¥
auto_recovery:
  enabled: true

  missing_research:
    action: "retry_with_cache"
    max_retries: 1

  low_editor_score:
    action: "trigger_revision"
    threshold: 70

  missing_experience_profile:
    action: "prompt_user_again"
    max_retries: 2
